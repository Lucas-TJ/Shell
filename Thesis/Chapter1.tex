\chapter{Introduction to medical simulation}
\label{chap1}


\section{General context}

Virtually everyone knows this situation where a close relative has to go to the hospital, either for a simple routine check or a serious surgery. Hospitals are meant to be re-insuring, a refuge where people's health improves, where people get fixed. Obviously, patient safety is a critical concern in the medical industry. Yet, patients have been known to suffer injuries or even death due to errors of judgement or a lack of care and training. As an example, a report published in 2000 by the Institute of Medicine in the United States \citep{Kohn00} described two studies carried out in the 1990s based on large samples of hospital admissions. They found that the proportion of hospital admissions experiencing an adverse event, defined as causes of injuries by medical management, were 2.9 and $3.7\,$\%, respectively. The proportion of these events attributable to errors (that is, preventable adverse events, in other words medical errors) was 58 and $53\,$\%, respectively. Even when using the lower estimate, deaths due to preventable adverse events in 1997 in the US ($44\,000$) exceeded the deaths attributable to motor vehicle accidents ($43\,458$), breast cancer ($42\,297$) or AIDS ($16\,516$). Because many errors go unreported, detailed statistics on medical errors are fairly scarce (hospitals usually do not attempt to emphasize errors). Nevertheless, the problem is real. And this is not surprising, elaborate skills have to be mastered in the medical field. Moreover, achieving a high degree of personal competence is sometimes not sufficient as various members of staff must learn how to work as a team. In fact, one of the recommendations of this report \citep{Kohn00} was to \emph{establish interdisciplinary team training programs for providers that incorporate proven methods of training, such as simulation}. However, dispensing an appropriate training in such a complex and hazardous environment is very challenging. Because healthcare is a high risk industry (like aviation or military), training in the real world is too costly and dangerous. Consequently, various approaches were applied for teaching and training of medical practicians over history of healthcare. 

\bigskip

The most basic form of medical simulators are simple models of human anatomy. Hundreds of years ago, representations in clay and stone were already used to demonstrate clinical features of disease states and their effects on humans. Models have been found from many cultures and continents. Nowadays, similar passive models are still used to help students learn the anatomy. In medical schools, live animals are also used for teaching physiology and surgery classes. Dogs, pigs, goats and sheep are commonly used in medical training. The exercises essentially consist in anaesthetising the animal and practicing surgical techniques. They may also be severely injured to teach participants how to treat and manage various traumatic injuries. If animal training allows a better realism than passive models, this type of training is being progressively abandoned because of both the prohibitive cost and obvious ethical reasons. Alternatives include active models of human patients that attempt to reproduce living anatomy or physiology. The first example was created in the early 1960s by Asmund Laerdal for training in mouth to mouth ventilation. This simulator of a dying victim not breathing and lacking a heart beat, became known as called Resusci-Anne and had been widely used for CPR training thanks to an internal spring attached to the chest wall \citep{Cooper04}. In the mid-1960s, Sim One became the first mannequin controlled by a computer. The chest was moved with breathing, the eyes blinked and the pupils could dilate for instance. But the computer technology was too expensive for commercialisation at the time and only one mannequin was built. Over time, computerised mannequins have substantially improved and today such systems are essentially integrated into training centres that aim at recreating the operating room environment. Scenarios can be created to expose medical professionals to diverse clinical situations with the goal of improving the communication between staff members. Rare but critical clinical situations that may require specialised training can also be simulated. Another approach to medical training, that may also be combined with computerised mannequins, is the use of computer-based simulators. Such systems provide an elegant solution for medical training since they can offer a realistic and configurable training environment. Computer-based simulators appear as an ideal tool to assess students' skills since virtually every parameter of the simulation can be measured and recorded. Increasing computational power and growing interest for the field over the last decade led to the rapid development of reasonably sophisticated simulation systems. Yet, computer-based simulators still face numerous challenges. 


\section{Challenges in computer-based simulation}

Because computer-based simulators are entirely virtual, the possibilities are almost infinite. The ideal simulator will ultimately feature a patient-specific anatomy obtained through a medical imaging technique (such as MRI or CT). It will also consider the actual properties of the anatomical structures of this given patient, to take into account both the variability in mechanical properties across patients and potential alterations due to diseases. Indeed, diseased organs are often much stiffer than healthy structures and this will affect the overall mechanical behaviour. The physiology relevant to the simulated procedure (motion caused by breathing, heart beat, blood flow, etc.) will have to be faithfully reproduced as well. Such a patient-specific simulator capable of replicating human physiology and pathologies would be a great instrument for medical training. Not only it would constitute an invaluable tool for teaching to medical students but it would also enable experts clinicians to practice rare and complex cases that they would otherwise never encounter before facing them in real life. Moreover, a highly realistic simulator would also allow planning of complex surgical procedures and per-operative guidance.

While substantial progress was accomplished during the past ten years, much remains to be done. In fact, the research described in this PhD fits in this context of computed-based simulation. Medical simulation can be broken up into different areas of research, all are very challenging.
%
\begin{description}
\item[Photo-realistic rendering:] first, the scene needs to look real. A rendered image can be understood in terms of a number of visible features that we want to reproduce in a simulated image: colours, brightness, shadows, reflection, transparency, refraction, diffraction, etc. Therefore, a series of fairly complex calculations is required for all visible structures within each image (usually displayed at $30\,$Hz). 
\item[Collision detection] involves algorithms to check for collision between solids. Without them, tools could go through organs and other obstacles during the simulation. The collision detection algorithm has to find all intersections between the objects at each time step of the simulation. 
\item[Contact modelling:] once the collision between two objects has been detected, a variety of responses to this contact may be formulated. The two solids may rebound away from each other, slide (with or without friction), or settle into relative static contact. This step must also be carried out at each time step. 
\item[Anatomical structure modelling and haptic feedback:] the simulator must also take into account the physics involved in the deformation of anatomical structures. Indeed, when a pressure is exerted on a given organ, the latter must deform and react according to its mechanical properties. The force created by this interaction may be sent back to the user through a so-called haptic device. This device provides the user with a sense of touch so he can feel the forces and vibrations due to the contact. The force feedback must take place at a very high frequency (often between $ 500 $ and $ 1\,000\,$Hz) for a smooth sense of touch. 
\end{description}
%
Although each of these steps alone is computationally demanding, the whole simulation process must be computed in real-time or close to real-time. Real-time means that one second of simulation corresponds to one second of real life. In that regard, a lot of work remains to be done in all these areas of research. Along with the increase in computational power, medical simulators endeavour to achieve the highest degree of realism possible. Of particular interest to us in this PhD is the accurate modelling of the deformation of anatomical structures in real-time. 

In the area of biomechanics, approaches for modelling anatomical structures became more elaborate and less approximative. These different approaches may be classified into three main categories: (1) geometrically based techniques, (2) approaches physically motivated and (3) methods based on the equations of continuum mechanics. Techniques based on geometry tolerate a degradation of realism as long as the result looks realistic and are typically used in the game industry. As an example, the technique of shape matching proposed by \cite{Muller05} makes use of a simple particle system without particle-particle interactions, but including response to collisions with the environment and including external forces such as gravity. But the most popular technique applied in simulation is the mass-spring system \citep{Terzopoulos91,Provot95,Mosegaard05b}. In this method, the geometry is described by a network of masses connected together by springs. The system of equations is solved using Newton's second law. Finally, the most computationally demanding techniques are the one relying on the equations of continuum mechanics. These equations are regarded as the most accurate mathematical description available for modelling the deformation of a continuum. The finite element method is a numerical procedure that allows to solve the partial differential equations provided by continuum mechanics \citep{Cotin99}. With the continual growth in computational power, finite element formulations applied to medical simulation become more elaborate \citep{Sagar94,Felippa00,Debunne01,Miller07}. For instance, they tend to employ more accurate constitutive laws to better describe the complex mechanical behaviour of organs. 

Yet, few biomechanical models can be computed in real-time and many approximations are still in use in medical simulation. Even though the mechanical behaviour of most organs is known to be non-linear, anisotropic and viscoelastic \citep{Fung93}, simple linear models are often employed in medical simulators. The resulting deformation of these organs is rather inaccurate and the force feedback provided to the user is not correct. Moreover, most of the proposed models are concerned with the mechanical behaviour of solid organs despite the fact that many thin and hollow anatomical structures may be found in the human body. To our knowledge, no model based on continuum mechanics was suggested in medical simulation to simulate the deformation of thin structures. Therefore, new algorithms are required for both type of structures. More elaborate models are suitable to better describe the complex behaviour of solid structures (with greater accuracy) and physics-based models are needed to model thin anatomical structures, all within the context of a real-time environment.


\section{Our contributions}

Through this PhD, we followed the trend of using more elaborate models capable of describing with great accuracy the mechanical behaviour of anatomical structures. Moreover, we strived to develop efficient formulations to model entire organs in real-time. Our work emerged from the following observation: the shape and the internal nature of the anatomical structures greatly differ. In the light of this statement, we believe that a unique model cannot deal with the variousness of the mechanical behaviours encountered in the human body. We identified two major types of structures in human body, they can be either solid (brain, liver, prostate etc.) or hollow (colon, blood vessels, stomach etc.). Consequently, this PhD thesis lies in two parts: solid structure modelling and hollow structure modelling. The first part deals with the first GPU implementation of a non-linear, anisotropic and viscoelastic finite element procedure. The second part introduces a framework for real-time modelling of thin anatomical structures via a parallelisable co-rotational shell finite element formulation and a method to mesh a complex surface with curved shell elements. In both cases, their implementation in the open source framework SOFA are presented. By providing these new models to the medical simulation community, we hope to assist in enhancing the realism of medical simulators. 




