\chapter{Conclusion and perspectives}
\label{chap11}


\section{Summary of contributions}

The objective of this PhD was to propose soft tissue models for computing the deformation of anatomical structures in real-time. Because the shape and the internal structure of these structures greatly differ, a unique model cannot deal with the variousness of the mechanical behaviours. Hence, we identified two major types of structures in human body, they can be either solid (brain, liver, prostate etc.) or hollow (colon, blood vessels, stomach etc.). 

Most of previous works focus on volumetric models that are able to capture the behaviour of solid organs. Yet, many of these models had to compromise on accuracy to achieve the real-time constraint demanded by medical simulation. Even though the best mathematical framework for predicting the deformation of a continuous structure is provided by continuum mechanics, solving these equations is a computationally very demanding task and simpler models are often used in practice. And even when the finite element method is employed to solve the equations of continuum mechanics, linear strain measure and simple constitutive laws are common and therefore does not constitute an appropriate modelling of the complex mechanical behaviours of solid anatomical structures. 

In contrast, much less research has been carried out for the modelling of hollow structures. In fact in the field of medical simulation, very few models have been proposed for simulating, in real-time, the deformation of thin anatomical structures whose volume is negligible compared to their surface area. Nevertheless, human body features many hollow structures and we feel that the need for modelling hollow organs in medical simulation is equally important as with solid organs. 

\bigskip

Consequently, we strived to propose solutions to these two known problems in the field of medical simulation.

\subsubsection*{Solid structure modelling.}
We implemented the total Lagrangian explicit dynamics (TLED) algorithm on GPU using CUDA. This finite element formulation is fully non-linear: it makes use of a non-linear strain measure (which allows large deformations) and embodies a non-linear constitutive law between strain and stress as characterised by \cite{Fung93} for soft-tissues. While the first GPU implementation of the TLED was carried out by \cite{Taylor07b} in the Cg language, our re-implementation in CUDA led to a threefold increase in performance. Overall, we observe a maximum speed improvement for GPU solution over CPU solution of up $56.3 \times$. My collaboration with Zeike Taylor continued and we enhanced the formulation by adding anisotropy and viscoelasticity. To the best of our knowledge, this work constitutes the first GPU implementation of a non-linear, anisotropic and viscoelastic finite element procedure. This formulation was eventually implemented in the open source framework for medical simulation SOFA and will be released publically with the upcoming 1.0 release of SOFA. By providing a fast and accurate non-linear FEM with various constitutive laws for soft tissue modelling to worldwide researchers, we thus hope to assist in enhancing the realism of medical simulators. 

\subsubsection*{Hollow structure modelling.}
We proposed a framework for real-time modelling of thin anatomical structures. We first designed a triangular shell element by combining a two-dimensional in-plane membrane energy, with an off-plane energy for describing bending and twist. We improved and extended a plate model first introduced by \cite{Przemieniecki85} to a co-rotational formulation to allow large displacements (but small deformations). Once combined with an in-plane membrane formulation we obtained an accurate, yet computationally efficient, shell finite element method featuring both membrane and bending energies. To the best of our knowledge, this co-rotational shell FEM is the first description of a shell finite element method in the field of medical simulation. However, to model the deformation of complex anatomical structures using shell elements, the first step is to describe its surface with curved patches. Indeed, while many flat triangles are required to describe highly curved surfaces, fewer triangular shell elements are needed to describe the given geometry with the same precision since they can be curved. Therefore, we suggested a simple method to mesh a surface with curved shell elements. The novelty of our method relies on the combination of a shell finite element formulation and a geometric surface reconstruction both based on the same polynomial interpolation function used to describe the surface of shells. We also showed how contacts and interactions with the curved surfaces of shells can be handled using the same function. 


\section{Discussion}

	\subsection{Solid structures modelling}

The TLED algorithm offers an accurate modelling for soft tissues and its GPU implementation using CUDA is very fast. Hence, real-time computations can be achieved without any trade-off on the accuracy of the deformation. One of the features allowing such an efficiency is the use of an explicit time integration scheme. If this permits significant computational advantage, the use of an explicit integration scheme imposes that the time step of the simulation remains below a critical time step. This critical time step depends on two kind of criterion: the size of the elements and the material?s properties (Young?s modulus and Poisson?s ratio). Therefore, meshing of anatomical structures to be simulated must be accomplished with great care to insure well-shaped elements. Even more restricting, the use of the TLED formulation is not suitable for modelling stiff objects in real-time. Indeed, increasing the Young's modulus translates into a lower critical time step, which necessitates an intensification of the simulation's frequency to enforce real-time. In some applications, the value of the Poisson?s ratio may be relaxed from 0.49 to 0.45 for instance. However, if it allows to double the critical time step, this relaxation introduces additional inaccuracies. 

One of the most common critics we received for this work concerned the poor ability of the TLED to handle interaction between organs and virtual tools. Indeed, interactions may impact the critical time step resulting from the use of an explicit time integration scheme and thus influence the overall stability of the simulation. The work carried out during my PhD was entirely concerned with the numerical solution provided by the TLED formulation. Yet, while this is beyond the scope of the present work, a range of contact formulations are available in commercial finite element packages. According to their documentation, the impact on the critical time step should be minimal. However, for a demonstration at an IT exhibition (CeBIT Australia), we tried to setup an interaction between a virtual tool driven by a haptic device and a cube with brain-like properties. If we managed to produce an interesting demo for the exhibition, its preparation brought out an unstable system. But even if a stable contact modelling technique could be formulated, the actual limiting factor is the collision detection process. Because the time step must be very small when using an explicit time integration scheme (often around one millisecond or less), the collision detection algorithm must also be run at the same frequency. The problem is that no collision detection algorithm is fast enough to execute at $ 1\,000\,$Hz or more with objects of reasonable sizes. One notable exception is the interaction with a fixed rigid surface where the collision detection is rapid. 

Consequently, this list of pros and cons limits the TLED's range of applications. If its usage in very interactive environments is not suitable, the TLED finite element algorithm is great at computing the deformation of soft tissues when the boundary conditions are known and controlled. Hence, provided that the application is appropriate, the TLED algorithm is an efficient and accurate algorithm to model the deformation of solid soft anatomical organs. 

	\subsection{Hollow structures modelling}
	
We achieved our objectives to propose a versatile solution which can simulate, in real-time, thin objects with various shapes and material properties with good accuracy. The efficiency of the method was illustrated through shell-based reconstruction and real-time simulation of the deformations of various anatomical structures and other thin objects. Nevertheless, the use of a linear strain measure limits the range of application to small deformations only. Moreover, the constitutive law was chosen to be the simple (linear) Hookean law, which it is known not to describe accurately the relationship between strain and stress in soft tissues. However, those potential changes are substantial and their implementations are not straightforward. In addition, it is not clear from which method the benefits would be the greatest: whether from enhancing our model to a non-linear formulation or completely changing to another model based on true shell theory (where membrane and bending energies are not separated). Our shell FEM could also be improved by implementing the formulation on GPU. Although an optimal parallel implementation is always challenging, our method is highly parallelisable and there is no major obstacle to an efficient GPU implementation.

Regarding our geometric surface reconstruction based on shells, we were able to mesh complex anatomical structures with a fairly small number of shell elements. However, the main drawback of our method is the lack of any assessment of the quality of the elements created. Indeed, if some elements are stretched from the heavy decimation, these elements are not corrected during the process of remeshing. Our algorithm could even worsen the situation by splitting those stretched elements into four smaller (and more stretched) elements. Yet, meshing a surface with curved elements is a very challenging problem and still an active area of research. In contrast to all geometrical techniques described in the literature, we presented a more physical approach consistent with our shell FEM formulation and obtained good results in meshing complex anatomical structures. 

	
	\subsection{Real-time constraint: use of GPU acceleration}	
	

\section{Perspectives}

