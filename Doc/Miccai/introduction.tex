Surgical interventions in infants with congenitally malformed great arteries and hearts are extremely challenging due to the complex and heterogeneous nature of their disease pattern. Cardiac surgeons rely on non-invasive imaging for patient-specific examination and possible appropriate surgical procedures may be sketched conceptually in advance, but the most promising approach is often chosen just in time during the actual open-heart operation. This is the first time the surgeon gets a concrete idea of possible outcomes for different surgical procedures. His decision has to be made in short time and is still based heavily on imagination capabilities and experience.

To improve planning of such pediatric cardiac surgeries it is possible to create 3-dimensional heart models out of acquired image data and to use them as input for surgical simulation systems. However, most present simulation systems focus on low-level surgical procedures, i.e. performing actual incisions and suturing with special input devices in real-time \cite{Sorensen2006,Mosegaard2004}. Their purpose is either by means of educational training or planning access strategies to reach the malformations of the heart or great arteries. In such {\itshape reactive} simulation systems it is more important to enable simulations in real-time than to simulate tissue and blood vessels in a physically accurate manner.

To be able to predict the result of complex surgical procedures, a physically correct simulation is mandatory. In \cite{Li2009}, a {\itshape predictive} surgical simulation system for bidirectional Glenn shunts and similar surgeries is presented. The authors use a hybrid model to simulate deformations of blood vessels by binding a surface mesh to a reference Cosserat rod elastically.
%While the mesh models surface details of blood vessels, the Cosserat rod models global deformations, i.e. stretching, bending, twisting and shearing
The simulation software performs low-level surgical procedures automatically with only a minimum of interaction required which allows the surgeon to focus on the actual overall surgical procedure.
%Although the results are promising, the method is limited to operations on uniform tubular structures that do not arbitrarily change the surface.
%Surgical procedures heavily changing surface details of blood vessels, i.e. patches for correction of complicated coarctations and stenosis, are not possible with this hybrid model since the physical behavior of blood vessels is simulated by the Cosserat rod and its {\itshape binding} to the surface mesh.
Although the results are promising, the method is limited to operations on uniform tubular structures and does not allow arbitrary manipulations of the surface mesh.

In this paper we present an improved approach using a simulation model solely based on elastic thin shell elements. Our method is not limited to well-formed blood vessels and captures all low-level procedures necessary for aortoplasty. We use a relaxation process to arbitrarily join or attach blood vessels and patches without using springs that would add surplus energy to the physical system. By taking the overall tubular structure of blood vessels into consideration during generation of thin shell elements we achieve reasonable speed of the simulation.

%We prove that simulation time is still reasonable or even decreased by taking special care of the overall tubular structure of blood vessels during generation of thin shell elements. 
%We improve the capabilities of the simulation by using a model based on elastic thin shell elements.
%This allows us to model arbitrary blood vessels and malformations of the artery.
%It can also capture all low-level procedures necessary for aortoplasty.
%By using a relaxation process we can arbitrarily join or attach blood vessels and patches without using springs that would add surplus energy to the physical system.
%\tomas{I don't think this is correct: (}
%We prove that simulation time is still reasonable or even decreased by taking special care of the overall tubular structure of blood vessels during generation of thin shell elements.
%\tomas{) we don't make any speed comparison. I propose this: }
%By taking into consideration the overall tubular structure of blood vessels during generation of thin shell elements we achieve reasonable speed of the simulation.
%\tomas{)}

%TODO: Include only a few sentences to CHD in general.
%
%Surgical interventions in infants with congenitally malformed great arteries and hearts can be difficult due to their disease pattern's complex and heterogeneous nature. Today, patient-specific 3-dimensional heart models can be acquired by modern techniques of non-invasive imaging and image post-processing [REFERENCE]. Nevertheless, cardiac surgeons tend to rely solely on subsets or 2-dimensional views of obtained 3-dimensional image data for examination. Possible appropriate surgical procedures may be sketched conceptually and the most promising approach is chosen just in time during the actual open-heart operation. 
%\christian{to modify [ }
%This is the first time the surgeon gets a concrete idea of possible outcomes for different surgical procedures. 
%However, his decision has to be made in relatively short time and can still be based heavily on imagination capabilities and experience.
%\christian{  ] }
%
%
%To improve planning of these kind of cardiac surgeries, obtained 3-dimensional heart models could be used as input for patient-specific surgical simulation systems. 
%
%\christian{not sure this is the right place for the following paragraph (It begins the state of the art while the work is not yet introduced) : [}
%Present simulation systems \christian{what simulation systems are we talking about ?}  focus on low-level surgical procedures [REFERENCES], i.e. performing actual incisions and suturing with special input devices in real-time. 
%Their purpose is either by means of educational training or planning access strategies to reach the heart's or blood vessel's malformations. 
%It is more important in such \emph{reactive} simulation systems to enable simulations in real-time than to simulate tissue and blood vessels in a physically accurate manner.
%\christian{ ] }
% 
%
%\christian{I think we should present our work as a continuity of what was proposed with the Cosserat model. We should reduce the discussion about this paper and show what is improved by our approach.}
%To be able to predict the result of complex surgical procedures, a physically correct simulation model must be used. 
%[REFERENCE] present a \emph{predictive} surgical simulation system for bidirectional Glenn shunts and basically similar surgeries. 
%They use a hybrid model to simulate deformations of blood vessel trees by binding a surface mesh to a reference Cosserat rod elastically.
%While the mesh models surface details of blood vessels, the Cosserat rod models global deformations, i.e. stretching, bending, twisting and shearing. 
%Low-level surgical procedures are done automatically by the software with only a minimum of interaction required which allows the surgeon to focus on the actual overall surgical procedure. 
%Furthermore the authors show that they can attach triangular shaped patches at loose ends of dissected vessels to allow joining of vessels with different circumferences. 
%Given the input of the surgeon, a typical simulation takes only seconds to produce a predictive result for further examination and evaluation of possibly undesired collisions or deformations of blood vessels. 
%Although the results are promising, the author's method is limited to uniform tubular structures and operations on them, i.e. joining blood vessels end-to-end or end-to-side. 
%Connection of blood vessels is done by using springs. 
%This approach introduces surplus energy to the physical system and special care has to be taken during the simulation to compensate for that. 
%Surgical procedures heavily changing surface details of blood vessels, i.e. arbitrary shaped patches to correct complicated coarctations and stenosis, are not possible with this hybrid model because the blood vessel's physical behavior is simulated by the Cosserat rod and its \emph{binding} to the surface mesh. 
%The authors state that more sophisticated physical models including finite element methods and thin shell elements would allow this but are computationally too expensive to produce results in reasonable time.
%
%
%\christian{\sout{In this paper we present an alternative}   Precisely, I propose to place our paper as an improvement of their approach } , universal approach using a simulation model solely based on elastic thin shell elements. 
%Our method is not limited to well-formed blood vessels and captures all low-level surgical procedures necessary for aortoplasty. 
%By using a relaxation process we arbitrarily join or attach blood vessels and patches anywhere without using springs that would add surplus energy to the physical system. 
%We prove that simulation time can be expected to be still reasonable or even decreased by taking special care of the blood vessel's overall tubular structure during generation of thin shell elements.
%
%TODO: Structure of Paper.
