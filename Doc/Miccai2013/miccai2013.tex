% http://www.miccai2013.org/submission_guideline.html
\documentclass{llncs}

\usepackage{makeidx}
\usepackage[pdftex]{graphicx}

%%% Comments
\usepackage{color}
\newcommand{\TG}[1]{{\color{blue}\textbf{TG: #1}}}
%%%

\newcommand{\Vec}[1]{\mathbf{#1}}
\newcommand{\Mat}[1]{\mathbf{#1}}

%\Figure{width}{name}{caption}
\newcommand{\Figure}[3]{%
\begin{figure}[htb]
  \centering
  \includegraphics[width=#1]{#2}
  \caption{\label{fig-#2}#3}
\end{figure}}

\begin{document}
%
%\frontmatter          % for the preliminaries
%
\mainmatter              % start of the contributions
%
\title{Complete Liver Model for Real-time Simulation} % TODO
% Or: Modelling the Glisson's Gapsule in Real-time Simulation of Liver
% or anything else ...
%
\titlerunning{TODO: Title}  % abbreviated title (for running head)
%                                     also used for the TOC unless
%                                     \toctitle is used
%
\author{Anonymous}
%\author{%
%Tom\'a\v{s} Golembiovsk\'y\inst{1,2} \and%
%Igor Peterl\'ik\inst{3} \and%
%Christian Duriez\inst{2} \and%
%Stephan\'e Cotin\inst{2,3}%
%}
%
%\authorrunning{Tom\'a\vs Golembiovsk\'y et al.} % abbreviated author list (for running head)
%
%\institute{%
%Faculty of Informatics, Masaryk University, Brno, Czech Republic\and%
%INRIA Lille -- Nord, France\and%
%IHU, Strasbourg, France%
%}
%
\maketitle

\begin{abstract}
This work provides a complete physical model for the deformations of the liver with its three constituents: parenchyma, vessels and the Glisson's capsule.
Some recent experimental results \cite{Ahn2010} have shown that there is a significant difference of stiffness between the Glisson's capsule and the parenchyma. 
Moreover, it has been observed that the capsule plays an important role for the deformation at the local level \cite{Hollenstein2006}.
However, the Glisson's capsule is very thin and its influence for the global deformations of the liver was never highlighted.
In this work, we propose to use a membrane FEM model for the capsule, that is coupled with a vascularized model of the liver.
We show that the approach is able to reproduce the deformations observed at the local level.
Additionally, we show, by simulating natural global deformations of the liver observed on real images (due to gravity), that the results have important differences with and without the capsule.

\keywords{liver, Glisson's capsule, deformation modeling, membrane}
\end{abstract}

\section{Introduction} %{{{

Medical simulation is expected to play an integral part in many aspects of
medical practice. From diagnosis, through planning or training to computer
assisted intervention. A good medical model has to be simple yet efficient
to be really usable.
The liver is usually modeled as a homogeneous isotropic (visco-)elastic
material \TG{refs}.% It is however non-homogeneous and modeling it as
%homogeneous necessarily requires complex non-linear material descriptions.
Recently
Peterl\'{i}k et al. \cite{Peterlik2012} showed the importance of the vascular
structures on the liver deformation.

Another often overlooked component is the Glisson's capsule.
Biomechanical measurements report that the capsule has very small
thickness (approx. 20 $\mu$m for porcine liver \cite{Umale2011}).
On the other hand it has in three orders of magnitude higher stiffness than
the parenchyma.
Because of this it plays an important role in local
deformations of the liver \cite{Ahn2010,Hollenstein2006}.
It was reported that evaluation of the liver as a homogeneous material
without capsule can lead to overestimation of local deformations up to the factor of 3
\cite{Hollenstein2006}.

While the influence on local deformation was reported, no experimental
results show whether the capsule also plays an important role on the global
deformations of the liver. We propose a composite model that models the
capsule with membrane FEM elements. We show that the model is able to
simulate expected local behaviour reported in literature. Further more we
show that the capsule plays also an important role in the deformation on
global scale.

\TG{summary of following sections.}

%}}}


\section{Model} %{{{

In this section we will describe the construction of our composite model.
It's three main parts are: tetrahedral model for parenchyma, membrane model
for capsule coupled to the parenchyma and beam model of vascular system as
proposed by Peterl\'{i}k et al. \cite{Peterlik2012}.

\subsection{Parenchyma} %{{{

It is known that the parenchyma exhibits viscoelastic behaviour \TG{Cite
something}, we however employ simpler elastic model as we are not so much
interested in time-dependent behaviour but rather in static equilibrium
under certain conditions.
%
The parenchyma is modeled using corotational finite elements. The corotational
formulation allows us to deal with geometrical non-linearities but still
rely on linear stress-strain relationship. Thus rotations and large
deformations are possible. In the corotational formulation the deformation
of each element is expressed in the local frame of reference. There are
several ways of computing the corotational frame for elements, we rely on
the geometrical method proposed in \cite{Nesme2005}.
% NOTE: This description of corotational method is very simplified and could be extended.
The stiffness matrix $\Mat{K}$ can be expressed in terms of the deformation
$u$ and the force as $\Vec{f} = \Mat{K}(\Vec{u}) \Vec{u}$. Where the
components of $\Mat{K}$ depend on the orientation of each element in the
current simulation step.

%}}}

\subsection{Glisson's Capsule} %{{{

The thickness of the Glisson's capsule is relatively small. Umale et al.
\cite{Umale2011} reported for porcine liver values in range of 10-20
$\mu$m.
It is not possible to model such thin structure with classical tetrahedral
elements. Modeling this non-homogeneous volumetric object would require a
dense mesh to avoid numerical instabilities and would significantly
violate the speed requirements imposed on medical simulators.
Instead modeling the capsule with two-dimensional elements that abstract from the
thickness in the third dimension seems
as a natural choice. Mechanics provides this a FE tool in the form of membranes
and shells. Based on the small thickness (compared to the surface area) we also
assume negligible bending forces and propose a model based on membrane
elements. 
To maintain simplicity of the composite model we choose simple triangular
elements with constant strain.

\TG{add a ref. or dive into the definition? \cite{Felippa2003}}

We again use linear elastic material and employ the corotational formulation
for the triangular elements.

%}}}

\subsection{Coupling Between Capsule and Parenchyma} %{{{

The literature reports high cohesion between capsule and parenchyma.
Based on this
property we may assume no relative motion of the capsule to the parenchyma.
While in general we could use arbitrary surface mesh for a capsule we use
the fact that the parenchyma is modeled by tetrahedral elements which have
triangular faces. Because the boundary of the volumetric mesh is already
triangulated, we only extract the boundary triangles which we use for the
model of capsule.

Using directly the boundary of the tetrahedral mesh does not only solve the
problem of obtaining the surface mesh, but has one more advantage. Nodes
of the triangular mesh overlap with nodes of the tetrahedral mesh and we do
not have to project nodes of triangular mesh onto the tetrahedra. More over,
the stiffness matrices for capsule and parenchyma are easily assembled
together and solved as one system.

Without the loss of generality we can assume the tetrahedron consists of
nodes $p_1, p_2, p_3$ and $p_4$ and the boundary triangle has nodes $p_1, p_2$
and $p_3$. We can reorder the degrees of freedom so that the stiffness
matrix $\Mat{K}^t$ for the tetrahedron can be written as:

\begin{equation}
  \Mat{K}^t = \left[\begin{array}{c|c}
      \Mat{K}^t_{1-3,1-3} & \Mat{K}^t_{1-3,4} \\
      \hline
      \Mat{K}^t_{4,1-3} & \Mat{K}^t_{4,4} \\
  \end{array}\right]
\end{equation}

Then the assembled stiffness matrix for the element is:

\begin{equation}
  \Mat{K} = \left[\begin{array}{c|c}
      \Mat{K}^t_{1-3,1-3} & \Mat{K}^t_{1-3,4} \\
      \hline
      \Mat{K}^t_{4,1-3} & \Mat{K}^t_{4,4} \\
  \end{array}\right]
  +
  \left[\begin{array}{c|c}
      \Mat{K}^m & 0 \\
      \hline
      0 & 0 \\
  \end{array}\right]
\end{equation}

Where $\Mat{K}^m$ is the stiffness matrix of the triangular membrane.
The resulting
system of linear equations is then solved by direct LDL solver.

%}}}

\subsection{Blood Vessels} %{{{

We also combined our composite model with vascularization method proposed
by Peterl\'{i}k et al. \cite{Peterlik2012}. The method is based on linear beams
with local frames of reference (in a many aspects similar to the
corotational formulation). As such the model also handles geometric
non-linearities in the deformation. The proposed model assumes no relative
motion of vessels to the parenchyma. Segmented vascular network is
discretized into the set of linear elements that are then projected into
the tetrahedral mesh of the parenchyma. During the simulation forces and
torques resulting from the deformations of vessels by parenchyma are
computed and propagated back onto the tetrahedral mesh.

%}}}

%}}}


\section{Experiments} %{{{

To evaluate the model we have implemented in the
SOFA\footnote{www.sofa-framework.org} framework and performed a set of
numerical simulations. First local deformations were compared to the
results reported in literature to validate the method. Then the model of
the complete liver was subjected to natural global deformations to asses
the importance of the capsule on the deformation.

Material properties used in the simulations were for a porcine liver as
reported by Umale \cite{Umale2013}. The
parenchyma was modeled with elastic modulus 1980~Pa and the capsule has
elastic modulus 8~MPa and thickness 20~$\mu$m.
\TG{values for blood vessels}

\subsection{Local deformations} %{{{

Hollenstein et al. \cite{Hollenstein2006} measured the response of the
bovine liver to the negative pressure using their aspiration test. One of
the observations was that the Glissons capsule has non-negligible influence
and modeling only the parenchyma leads to overestimation of the
deformation. We reproduced the test with our model and acquired similar
results.

The aspiration device consists of a tube with 1 cm in diameter and is able
to control internal pressure in the tube. The test is performed by
attaching the tube to the tissue and meassuring the tissue response. We
have set up a simulation in the spirit of this test. 
% TODO: fix the scene! tube has 5 mm radius, not 1 cm
The simulation is performed with a 3x3x3 cm cube of liver tissue and tube
with 1 cm radius. The pressure of 2 kPa is simulated inside the tube.

Figure \ref{fig-aspiration} shows the profiles of cuts in the middle of the
cube for the model with and without capsule. It can be seen that the
deformation for the model without capsule is much larger which is in
aggreement with the data obtained by Hollenstein et al.

\Figure{4in}{aspiration}{TODO: aspiration test; fix figure, add screenshot}

%}}}


\subsection{Global Deformations}

\TG{!!!}

Test 1) Global deformation of liver under gravity
  * show that there is a difference between simple homogeneous material
    and material with capsule
  * include blood vessels

%}}}

\section{Conclusion} %{{{

A composite model for simulation of complete liver is presented in the
paper. The work of Peterlik et al. for vaskularized liver model was
extended by addig the capsule modeled with membrane FEM model mechanically
coupled with the parenchyma. To validate the model a simulation of local
deformations was performed and was found in an aggrement with the results
measured and published by Hollenstein et al.

While the influence of the capsule on local deformations was previously
studied in the literature, it's significance on the global scale
deformations of the liver remained unexplored. We have performed a set of
natural global deformations of the complete liver and shown that the
capsule, despite its small thickness, plays a significant role also in
global context.

%}}}

%
% ---- Bibliography ----
%

\bibliographystyle{splncs03}
\bibliography{bibdata}


\end{document}
% vim:set et sw=2 tw=75 fdm=marker fdl=3 fdc=4 isk+=_,-:
