<?xml version="1.0"?>
<Node gravity="0 -9.8 0">
    <VisualStyle displayFlags="showVisual" />

    <Node name="mesh">
        <VisualStyle displayFlags="showWireframe" />
        <MeshObjLoader name="loader" filename="mesh.obj" />
        <TriangleSetTopologyContainer name="topology" src="@loader" />
        <MechanicalObject template="Rigid" position="@loader.position" />
        <!--<OglModel name="visual" color="0.75 0 0" />
        <IdentityMapping input="@." output="@visual" />-->
    </Node>

    <Node name="fixedPoints">
        <VisualStyle displayFlags="showBehavior" />
        <MechanicalObject
            name="mechanicalObject"
            position="
                3.998132 1.051143 -1.000002 0 0 0 1
                4.073385 0.871150 -0.980787 0 0 0 1
                4.145745 0.698075 -0.923881 0 0 0 1
                4.212434 0.538567 -0.831470 0 0 0 1
                4.270886 0.398758 -0.707107 0 0 0 1
                4.318856 0.284020 -0.555570 0 0 0 1
                4.354502 0.198762 -0.382683 0 0 0 1
                4.376452 0.146261 -0.195090 0 0 0 1
                4.383863 0.128533 0.000001 0 0 0 1
                4.376451 0.146261 0.195091 0 0 0 1
                4.354502 0.198763 0.382683 0 0 0 1
                4.318856 0.284022 0.555569 0 0 0 1
                4.270885 0.398760 0.707106 0 0 0 1
                4.212433 0.538569 0.831468 0 0 0 1
                4.145745 0.698076 0.923878 0 0 0 1
                4.073384 0.871151 0.980784 0 0 0 1
                3.998132 1.051143 0.999998 0 0 0 1
                3.922880 1.231135 0.980784 0 0 0 1
                3.850519 1.404210 0.923879 0 0 0 1
                3.783831 1.563718 0.831469 0 0 0 1
                3.725379 1.703527 0.707107 0 0 0 1
                3.677408 1.818265 0.555571 0 0 0 1
                3.641762 1.903524 0.382685 0 0 0 1
                3.619812 1.956027 0.195092 0 0 0 1
                3.612400 1.973755 0.000002 0 0 0 1
                3.619811 1.956028 -0.195088 0 0 0 1
                3.641761 1.903527 -0.382680 0 0 0 1
                3.677406 1.818269 -0.555568 0 0 0 1
                3.725376 1.703532 -0.707104 0 0 0 1
                3.783829 1.563724 -0.831468 0 0 0 1
                3.850516 1.404217 -0.923879 0 0 0 1
                3.922877 1.231143 -0.980786 0 0 0 1"
            template="Rigid" />
        <FixedConstraint indices="0-31" />
    </Node>

    <Node name="simulation">
        <EulerImplicit />
        <CGLinearSolver iterations="100" tolerance="1e-9" threshold="1e-9" />

        <TriangleSetTopologyContainer src="@/mesh/loader" />
        <MechanicalObject name="state" template="Rigid" rest_position="@/mesh/loader.position" />
        <UniformMass showAxisSizeFactor="0.1" totalMass="1" />

        <RestShapeSpringsForceField
            angularStiffness="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"
            external_points="0-31"
            external_rest_shape="/fixedPoints/mechanicalObject"
            points="1018-998 1029-1019"
            stiffness="5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000 5000"
            template="Rigid" />

        <FixedConstraint indices="177-192 1637-1668" />

        <Node>
            <BezierTriangularBendingFEMForceField
                normals="@/mesh/loader.normals"
                poissonRatio="0.5"
                thickness="0.2"
                youngModulus="10000" />
                
                <Node>
                    <OglModel name="visual" color="1 1 1" />
                    <IdentityMapping input="@.." output="@visual" />
                </Node>
        </Node>

    </Node>

</Node>
